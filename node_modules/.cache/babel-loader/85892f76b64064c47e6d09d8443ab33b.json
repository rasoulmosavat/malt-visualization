{"ast":null,"code":"\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports[\"default\"] = void 0;\n\nvar _classCallCheck2 = _interopRequireDefault(require(\"@babel/runtime/helpers/classCallCheck\"));\n\nvar _createClass2 = _interopRequireDefault(require(\"@babel/runtime/helpers/createClass\"));\n\nvar _error = require(\"../error\");\n/**\n * Copyright (c) 2002-2020 \"Neo4j,\"\n * Neo4j Sweden AB [http://neo4j.com]\n *\n * This file is part of Neo4j.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n\nvar ConnectionErrorHandler = /*#__PURE__*/function () {\n  function ConnectionErrorHandler(errorCode, handleUnavailability, handleWriteFailure) {\n    (0, _classCallCheck2[\"default\"])(this, ConnectionErrorHandler);\n    this._errorCode = errorCode;\n    this._handleUnavailability = handleUnavailability || noOpHandler;\n    this._handleWriteFailure = handleWriteFailure || noOpHandler;\n  }\n  /**\n   * Error code to use for network errors.\n   * @return {string} the error code.\n   */\n\n\n  (0, _createClass2[\"default\"])(ConnectionErrorHandler, [{\n    key: \"errorCode\",\n    value: function errorCode() {\n      return this._errorCode;\n    }\n    /**\n     * Handle and transform the error.\n     * @param {Neo4jError} error the original error.\n     * @param {ServerAddress} address the address of the connection where the error happened.\n     * @return {Neo4jError} new error that should be propagated to the user.\n     */\n\n  }, {\n    key: \"handleAndTransformError\",\n    value: function handleAndTransformError(error, address) {\n      if (isAvailabilityError(error)) {\n        return this._handleUnavailability(error, address);\n      }\n\n      if (isFailureToWrite(error)) {\n        return this._handleWriteFailure(error, address);\n      }\n\n      return error;\n    }\n  }]);\n  return ConnectionErrorHandler;\n}();\n\nexports[\"default\"] = ConnectionErrorHandler;\n\nfunction isAvailabilityError(error) {\n  if (error) {\n    return error.code === _error.SESSION_EXPIRED || error.code === _error.SERVICE_UNAVAILABLE || error.code === 'Neo.TransientError.General.DatabaseUnavailable';\n  }\n\n  return false;\n}\n\nfunction isFailureToWrite(error) {\n  if (error) {\n    return error.code === 'Neo.ClientError.Cluster.NotALeader' || error.code === 'Neo.ClientError.General.ForbiddenOnReadOnlyDatabase';\n  }\n\n  return false;\n}\n\nfunction noOpHandler(error) {\n  return error;\n}","map":{"version":3,"sources":["d:/webback/pro5/node_modules/neo4j-driver/lib/internal/connection-error-handler.js"],"names":["_interopRequireDefault","require","Object","defineProperty","exports","value","_classCallCheck2","_createClass2","_error","ConnectionErrorHandler","errorCode","handleUnavailability","handleWriteFailure","_errorCode","_handleUnavailability","noOpHandler","_handleWriteFailure","key","handleAndTransformError","error","address","isAvailabilityError","isFailureToWrite","code","SESSION_EXPIRED","SERVICE_UNAVAILABLE"],"mappings":"AAAA;;AAEA,IAAIA,sBAAsB,GAAGC,OAAO,CAAC,8CAAD,CAApC;;AAEAC,MAAM,CAACC,cAAP,CAAsBC,OAAtB,EAA+B,YAA/B,EAA6C;AAC3CC,EAAAA,KAAK,EAAE;AADoC,CAA7C;AAGAD,OAAO,CAAC,SAAD,CAAP,GAAqB,KAAK,CAA1B;;AAEA,IAAIE,gBAAgB,GAAGN,sBAAsB,CAACC,OAAO,CAAC,uCAAD,CAAR,CAA7C;;AAEA,IAAIM,aAAa,GAAGP,sBAAsB,CAACC,OAAO,CAAC,oCAAD,CAAR,CAA1C;;AAEA,IAAIO,MAAM,GAAGP,OAAO,CAAC,UAAD,CAApB;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AACA,IAAIQ,sBAAsB,GAC1B,aACA,YAAY;AACV,WAASA,sBAAT,CAAgCC,SAAhC,EAA2CC,oBAA3C,EAAiEC,kBAAjE,EAAqF;AACnF,KAAC,GAAGN,gBAAgB,CAAC,SAAD,CAApB,EAAiC,IAAjC,EAAuCG,sBAAvC;AACA,SAAKI,UAAL,GAAkBH,SAAlB;AACA,SAAKI,qBAAL,GAA6BH,oBAAoB,IAAII,WAArD;AACA,SAAKC,mBAAL,GAA2BJ,kBAAkB,IAAIG,WAAjD;AACD;AACD;AACF;AACA;AACA;;;AAGE,GAAC,GAAGR,aAAa,CAAC,SAAD,CAAjB,EAA8BE,sBAA9B,EAAsD,CAAC;AACrDQ,IAAAA,GAAG,EAAE,WADgD;AAErDZ,IAAAA,KAAK,EAAE,SAASK,SAAT,GAAqB;AAC1B,aAAO,KAAKG,UAAZ;AACD;AACD;AACJ;AACA;AACA;AACA;AACA;;AAVyD,GAAD,EAYnD;AACDI,IAAAA,GAAG,EAAE,yBADJ;AAEDZ,IAAAA,KAAK,EAAE,SAASa,uBAAT,CAAiCC,KAAjC,EAAwCC,OAAxC,EAAiD;AACtD,UAAIC,mBAAmB,CAACF,KAAD,CAAvB,EAAgC;AAC9B,eAAO,KAAKL,qBAAL,CAA2BK,KAA3B,EAAkCC,OAAlC,CAAP;AACD;;AAED,UAAIE,gBAAgB,CAACH,KAAD,CAApB,EAA6B;AAC3B,eAAO,KAAKH,mBAAL,CAAyBG,KAAzB,EAAgCC,OAAhC,CAAP;AACD;;AAED,aAAOD,KAAP;AACD;AAZA,GAZmD,CAAtD;AA0BA,SAAOV,sBAAP;AACD,CAxCD,EAFA;;AA4CAL,OAAO,CAAC,SAAD,CAAP,GAAqBK,sBAArB;;AAEA,SAASY,mBAAT,CAA6BF,KAA7B,EAAoC;AAClC,MAAIA,KAAJ,EAAW;AACT,WAAOA,KAAK,CAACI,IAAN,KAAef,MAAM,CAACgB,eAAtB,IAAyCL,KAAK,CAACI,IAAN,KAAef,MAAM,CAACiB,mBAA/D,IAAsFN,KAAK,CAACI,IAAN,KAAe,gDAA5G;AACD;;AAED,SAAO,KAAP;AACD;;AAED,SAASD,gBAAT,CAA0BH,KAA1B,EAAiC;AAC/B,MAAIA,KAAJ,EAAW;AACT,WAAOA,KAAK,CAACI,IAAN,KAAe,oCAAf,IAAuDJ,KAAK,CAACI,IAAN,KAAe,qDAA7E;AACD;;AAED,SAAO,KAAP;AACD;;AAED,SAASR,WAAT,CAAqBI,KAArB,EAA4B;AAC1B,SAAOA,KAAP;AACD","sourcesContent":["\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports[\"default\"] = void 0;\n\nvar _classCallCheck2 = _interopRequireDefault(require(\"@babel/runtime/helpers/classCallCheck\"));\n\nvar _createClass2 = _interopRequireDefault(require(\"@babel/runtime/helpers/createClass\"));\n\nvar _error = require(\"../error\");\n\n/**\n * Copyright (c) 2002-2020 \"Neo4j,\"\n * Neo4j Sweden AB [http://neo4j.com]\n *\n * This file is part of Neo4j.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nvar ConnectionErrorHandler =\n/*#__PURE__*/\nfunction () {\n  function ConnectionErrorHandler(errorCode, handleUnavailability, handleWriteFailure) {\n    (0, _classCallCheck2[\"default\"])(this, ConnectionErrorHandler);\n    this._errorCode = errorCode;\n    this._handleUnavailability = handleUnavailability || noOpHandler;\n    this._handleWriteFailure = handleWriteFailure || noOpHandler;\n  }\n  /**\n   * Error code to use for network errors.\n   * @return {string} the error code.\n   */\n\n\n  (0, _createClass2[\"default\"])(ConnectionErrorHandler, [{\n    key: \"errorCode\",\n    value: function errorCode() {\n      return this._errorCode;\n    }\n    /**\n     * Handle and transform the error.\n     * @param {Neo4jError} error the original error.\n     * @param {ServerAddress} address the address of the connection where the error happened.\n     * @return {Neo4jError} new error that should be propagated to the user.\n     */\n\n  }, {\n    key: \"handleAndTransformError\",\n    value: function handleAndTransformError(error, address) {\n      if (isAvailabilityError(error)) {\n        return this._handleUnavailability(error, address);\n      }\n\n      if (isFailureToWrite(error)) {\n        return this._handleWriteFailure(error, address);\n      }\n\n      return error;\n    }\n  }]);\n  return ConnectionErrorHandler;\n}();\n\nexports[\"default\"] = ConnectionErrorHandler;\n\nfunction isAvailabilityError(error) {\n  if (error) {\n    return error.code === _error.SESSION_EXPIRED || error.code === _error.SERVICE_UNAVAILABLE || error.code === 'Neo.TransientError.General.DatabaseUnavailable';\n  }\n\n  return false;\n}\n\nfunction isFailureToWrite(error) {\n  if (error) {\n    return error.code === 'Neo.ClientError.Cluster.NotALeader' || error.code === 'Neo.ClientError.General.ForbiddenOnReadOnlyDatabase';\n  }\n\n  return false;\n}\n\nfunction noOpHandler(error) {\n  return error;\n}"]},"metadata":{},"sourceType":"script"}